<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Attendance Sheet + Instructor Panel</title>

  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap" rel="stylesheet" />

  <style>
    /* (UNCHANGED CSS – keeping yours exactly the same) */
    html,body{margin:0;padding:0;height:100%;font-family:'Lato',sans-serif;background:linear-gradient(70deg,rgba(61,110,53,1),rgba(14,75,100,1));color:#fff;overflow:hidden}
    body{display:flex;flex-direction:column;align-items:center;height:100vh;padding:20px;box-sizing:border-box;overflow:hidden}
    .logo{max-width:30%;height:auto;margin:20px 0 40px}
    .breadcrumb{margin-bottom:20px;font-size:16px;font-weight:bold;color:#fff}
    .breadcrumb span{cursor:pointer;text-decoration:underline;color:#cdebf5}
    .breadcrumb span:hover{color:#fff}
    .venue-message,.day-message{font-size:18px;font-weight:500;color:#fff;margin-bottom:20px;transition:.6s}
    .venue-message.hidden,.day-message.hidden{opacity:0;pointer-events:none;height:0;margin:0;overflow:hidden}
    .button-section{display:flex;flex-direction:column;align-items:stretch;gap:12px;width:100%;max-width:600px;height:70vh;overflow-y:auto;padding-right:5px}
    .button-section::-webkit-scrollbar{width:40px}
    .button-section::-webkit-scrollbar-thumb{background:url('Picture1.png') no-repeat center center;background-size:contain;border-radius:10px;border:none}
    .modal-content::-webkit-scrollbar,.panel-content::-webkit-scrollbar{width:40px}
    .modal-content::-webkit-scrollbar-thumb,.panel-content::-webkit-scrollbar-thumb{background:url('Picture1.png') no-repeat center center;background-size:contain;border-radius:10px;border:none}
    .filter-button{padding:10px 16px;background:#fff;color:#144F5F;border:none;border-radius:6px;cursor:pointer;font-weight:600;font-size:14px;width:100%;max-height:48px;text-align:left}
    .filter-button:hover{background:#144F5F;color:#fff}
    #backButton{padding:8px 16px;font-size:14px;max-width:150px;background:#fff;color:#144F5F;border:none;border-radius:6px;cursor:pointer;font-weight:600;margin-bottom:20px}
    #backButton:hover{background:#144F5F;color:#fff}
    .hidden{display:none}
    .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);justify-content:center;align-items:center;z-index:1000}
    .modal-content{background:#fff;color:#0E4B64;padding:20px;border-radius:10px;max-width:90%;width:900px;max-height:90vh;overflow-y:auto;box-shadow:0 4px 15px rgba(0,0,0,.3)}
    .modal-close{float:right;font-size:20px;cursor:pointer}
    table{width:100%;border-collapse:collapse;margin-top:12px;font-size:14px;color:#0E4B64;border:1px solid #cdebf5}
    th,td{border:1px solid #cdebf5;padding:10px;vertical-align:top;background:#fff}
    th{color:#0E4B64;font-weight:800;text-align:left;width:25%}
    .panel{position:fixed;right:16px;bottom:16px;width:360px;background:#fff;color:#0E4B64;border-radius:16px;box-shadow:0 10px 28px rgba(0,0,0,.35);overflow:hidden;display:none;z-index:1200;transition:all .3s}
    .panel.minimized{width:300px;height:50px}
    .panel.maximized{width:500px;max-height:80vh}
    .panel-header{display:flex;justify-content:space-between;align-items:center;background:#0E4B64;color:#fff;padding:8px 12px;font-weight:800}
    .panel-header-buttons{display:flex;gap:8px}
    .panel-header-buttons button{background:none;border:none;color:#fff;font-weight:bold;cursor:pointer;font-size:16px;padding:0 4px}
    .panel-content{padding:12px;overflow-y:auto;max-height:58vh}
    .panel.minimized .panel-content{display:none}
    .panel-hero{display:flex;align-items:center;gap:12px;margin-bottom:12px}
    .panel-hero img{width:72px;height:72px;border-radius:50%;object-fit:cover;border:3px solid #cdebf5}
    .who{font-size:16px;font-weight:900}
    .muted{font-size:12px;color:#517b89;font-weight:700}
    .chip{display:inline-block;border-radius:999px;margin:3px 5px 0 0;font-weight:700;background:#e6f6fb;color:#0E4B64;transform:scale(0.85);font-size:11px;opacity:0;animation:growWave .6s ease forwards;padding:4px 8px}
    @keyframes growWave{0%{transform:scale(.85);opacity:0}60%{transform:scale(1.08);opacity:1}100%{transform:scale(1);opacity:1}}
    .collapsible-title{font-size:13px;font-weight:500;color:#0E4B64;margin-top:8px;margin-bottom:6px;cursor:pointer;transition:color .3s ease}
    .collapsible-title:hover{color:#155d78}
    .collapsible-content{max-height:0;overflow:hidden;transition:max-height .4s ease}
    .collapsible-content.active{max-height:500px}
    .loading{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-size:20px;font-weight:bold}
    .error-message{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(255,0,0,0.9);color:#fff;padding:20px;border-radius:10px;max-width:80%;text-align:center}
  </style>
</head>

<body>

  <!-- LOAD DATA FILES -->
  <script src="./instructors.js"></script>
  <script src="./subjects.js"></script>   <!-- ⭐ NEW -->

  <script>
    // ========= ADD THIS HELPER ========= ⭐ NEW
    function getSubjectDescription(idOrTitle) {
      if (!window.subjectsMap) return '';

      // Try ID match first
      if (window.subjectsMap[idOrTitle]) {
        return window.subjectsMap[idOrTitle].description || '';
      }

      // Try title match fallback
      var t = (idOrTitle || '').toLowerCase();
      for (var k in window.subjectsMap) {
        var s = window.subjectsMap[k];
        if (s && s.title && t.indexOf(s.title.toLowerCase()) !== -1) {
          return s.description || '';
        }
      }
      return '';
    }
  </script>

  <!-- (ALL YOUR CURRENT BODY CONTENT HERE — UNCHANGED UNTIL showClassDetails) -->

  <script>
    /* … your JS stays the same until this function … */

    function showClassDetails(cls, id) {

      var students = cls.students || [];
      var emp = '';

      for (var i = 0; i < students.length; i++) {
        var s = students[i];
        var parts = [s["First Name"], s["Middle Name"], s["Last Name"]].filter(function(p) { return p; });
        var fullName = parts.join(" ");
        emp += '<div><strong>' + s["User ID"] + '</strong> - ' + fullName + '</div>';
      }

      var inst = cls.instructor || '';

      // ⭐ NEW — GET DESCRIPTION USING ID OR TITLE
      var courseDesc = getSubjectDescription(id) || getSubjectDescription(cls.title);

      var link = inst
        ? '<a href="#" onclick="openInstructorPanel(\'' + inst.replace(/'/g, "\\'") + '\');return false;">' + inst + '</a>'
        : '';

      document.getElementById('classDetails').innerHTML =
        '<h3 style="color:#144F5F;text-align:center;">' + cls.title + ' (ID: ' + id + ')</h3>' +
        '<table>' +
        '<tr><th>Instructor</th><td>' + link + '</td></tr>' +
        '<tr><th>Start Time</th><td>' + (cls.start_time || '') + '</td></tr>' +
        '<tr><th>End Time</th><td>' + (cls.end_time || '') + '</td></tr>' +
        '<tr><th>Venue</th><td>' + (cls.venue || '') + '</td></tr>' +
        '<tr><th>Employee Count</th><td>' + (cls.student_count || students.length) + '</td></tr>' +

        // ⭐ NEW ROW HERE
        '<tr><th>Course Description</th><td>' + (courseDesc || '—') + '</td></tr>' +

        '<tr><th>Employees</th><td>' + emp + '</td></tr>' +
        '</table>';

      document.getElementById('classModal').style.display = 'flex';
    }

    /* everything else remains EXACTLY as-is */
  </script>
</body>
</html>
